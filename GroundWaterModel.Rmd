---
title: "ESM 203: Assignment 3"
author: "Madeline Gorchels"
date: "11/15/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(kableExtra)
library(knitr)

gw_mgmt = read_csv("ESM203Assn3.csv")

```

```{r}
##Part 1: Making a regression for the outflow

outflow_reg = lm(outflow~year, data=gw_mgmt)

outflow_reg$fitted #this will show me the regression lines values for the points I put in. Unhelpful in this case 

#now I'm going to use my model 

outflow_reg$coefficients # shows my y intercept and slope

#This uses the model automatically
coef(outflow_reg)[1] #this is the intercept
coef(outflow_reg)[2] #this is the slope

coef(outflow_reg)[1]+coef(outflow_reg)[2]*2002 #example using 2002

#apparently there is a neater way
predict(outflow_reg,list(year=2002)) # for a single value
outflow_mod = predict(outflow_reg,data.frame(year=c(2000:2050))) #this generates a new data frame using the years between 2000 and 2050.

#View(outflow_mod)
```

```{r}
##Part 2. Making an Inflow Model 

inflow_reg = lm(inflow~year, data=gw_mgmt)

inflow_reg$fitted #this will show me the regression lines values for the points I put in. Unhelpful in this case 

#now I'm going to use my model 
inflow_reg$coefficients # shows my y intercept and slope

#This uses the model automatically
coef(inflow_reg)[1] #this is the intercept
coef(inflow_reg)[2] #this is the slope

coef(inflow_reg)[1]+coef(inflow_reg)[2]*2002 #example using 2002

#apparently there is a neater way
predict(inflow_reg,list(year=2002)) # for a single value
inflow_mod = predict(inflow_reg,data.frame(year=c(2000:2050))) #this is getting exciting
#View(inflow_mod)
```
```{r}
netloss = predict(outflow_reg,data.frame(year=c(2000:2050)))- predict(inflow_reg,data.frame(year=c(2000:2050)))

lowerCI = 190
  for (i in 1:50) {lowerCI[i+1] = lowerCI[i] - netloss[i]}
mean = 350
  for (i in 1:50) {mean[i+1] = mean[i] - netloss[i]}
upperCI = 550
  for (i in 1:50) {upperCI[i+1] = upperCI[i] - netloss[i]}

mean_gw = 350
gw_df = data.frame(matrix(ncol = 7, nrow = 51))
x = c("year", "outflow", "inflow", "netloss", "reservoir_190", "resevoir_350", "resevoir_550")
colnames(gw_df) = x
gw_model = gw_df %>% 
  mutate(year = 2000:2050) %>% 
  mutate(outflow = predict(outflow_reg,data.frame(year=c(2000:2050)))) %>% 
  mutate(inflow = predict(inflow_reg,data.frame(year=c(2000:2050)))) %>%
  mutate(netloss = outflow-inflow) %>% 
  mutate(reservoir_190 = lowerCI) %>% 
  mutate(resevoir_350 = mean) %>% 
  mutate(resevoir_550 = upperCI)



#View(gw_model)



```

